name: Content Engine

on:
  schedule:
    - cron: '0 4 * * *' # Runs at 4:00 AM UTC
  workflow_dispatch:

jobs:
  write_and_publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install Dependencies
        run: pip install requests

      - name: Write Article
        env:
          GROQ_API_KEY: ${{ secrets.GROQ_API_KEY }}
        run: python article_writer.py

      - name: Publish Content
        env:
          # ðŸ”¥ FIX: Variable name must match Python code (DEVTO_KEY_NEW)
          DEVTO_KEY_NEW: ${{ secrets.DEVTO_KEY_NEW }} 
          HASHNODE_TOKEN: ${{ secrets.HASHNODE_TOKEN }}
          HASHNODE_PUB_ID: ${{ secrets.HASHNODE_PUB_ID }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          SMTP_EMAIL: ${{ secrets.SMTP_EMAIL }}
          SMTP_PASSWORD: ${{ secrets.SMTP_PASSWORD }}
          BLOGGER_EMAIL: ${{ secrets.BLOGGER_EMAIL }}
        run: python publisher.py

